{% extends 'layout.html' %} {% block content %}
<div class="max-w-4xl mx-auto">
    {% if article %}
    <!-- Article View Mode -->
    <div class="bg-white rounded-lg shadow-md overflow-hidden">
        <div class="p-6">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">
                {{ article.title }}
            </h1>

            <div class="flex items-center text-gray-500 text-sm mb-6">
                <span>By {{ article.author.name }}</span>
                <span class="mx-2">â€¢</span>
                <span>{{ article.at }}</span>
            </div>

            {% if article.images and article.images|length > 0 %}
            <div class="mb-6 flex gap-4 overflow-x-auto py-2">
                {% for image in article.images %}
                <img
                    src="{{ image.path }}"
                    alt="Article image"
                    class="rounded-lg max-h-80 object-cover"
                />
                {% endfor %}
            </div>
            {% endif %}

            <div class="prose max-w-none">{{ article.content|safe }}</div>

            {% if user_id == article.author.id %}
            <div class="mt-8 flex gap-4">
                <a
                    href="/article/{{ article.id }}/edit"
                    class="bg-gray-800 text-white px-4 py-2 rounded hover:bg-gray-700 transition duration-200"
                >
                    Edit Article
                </a>

                <button
                    hx-delete="/article/{{ article.id }}"
                    hx-confirm="Are you sure you want to delete this article?"
                    hx-target="body"
                    hx-swap="outerHTML"
                    class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition duration-200"
                >
                    Delete
                </button>
            </div>
            {% endif %}
        </div>
    </div>
    {% elif message %}
    <!-- Success Message -->
    <div
        class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-6"
        role="alert"
    >
        <p>{{ message }}</p>
    </div>

    <div class="flex justify-between">
        <a
            href="/"
            class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
        >
            Back to Home
        </a>
        <a
            href="/article/new"
            class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
        >
            Write Another Article
        </a>
    </div>
    {% else %}
    <!-- New Article Form -->
    <div id="article-container">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">
            Create New Article
        </h1>

        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <div class="p-6">
                <form
                    hx-post="/article"
                    hx-ext="json-enc"
                    hx-target="#article-container"
                    class="space-y-6"
                >
                    <div>
                        <label
                            for="title"
                            class="block text-sm font-medium text-gray-700"
                            >Title</label
                        >
                        <input
                            type="text"
                            id="title"
                            name="title"
                            required
                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                        />
                    </div>

                    <div>
                        <label
                            for="content"
                            class="block text-sm font-medium text-gray-700"
                            >Content</label
                        >
                        <textarea
                            id="content"
                            name="content"
                            rows="12"
                            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:border-gray-500"
                            required
                        ></textarea>
                        <p class="mt-1 text-sm text-gray-500">
                            Write your article content here. You can use
                            Markdown syntax for formatting.
                        </p>
                    </div>

                    <div>
                        <button
                            type="submit"
                            class="inline-flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gray-800 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"
                        >
                            Publish Article
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
